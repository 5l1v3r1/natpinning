<html>
	<head>
		<title>Gremwell NAT Pinning test suite</title>
	</head>
	<body onload="">
	 <script type="text/javascript" src="tools.js"></script>
	 <script type="text/javascript" src="admin.js"></script>
	 <script type="text/javascript" src="screen.js"></script>
	<link rel="STYLESHEET" type="text/css" media="screen" href="admin.css" />
	 <script language="JavaScript">
			function loadSWF(){
				var proto = "cmd";
				var server = document.location.hostname;//defaulting to same host
				var callbackip = "";
				var callbackport = "";
				//where dragons be
				var swfEl = createSwfObject('exploit.swf', {id: 'myid', class: 'myclass', width: 1, height: 1}, {wmode: 'transparent',allowScriptAccess: 'allways', FlashVars : 'ci='+ gClientId +'&server='+ server +'&cmdURL='+gCmdURL});
				document.body.appendChild(swfEl);
			}
			function nextStep(){
				if (gCurrStep==1){
					var strMyIp = document.getElementById("step1_myIP").value;
					if(isValidIp4(strMyIp)){
						gMyIP=strMyIp;
						gClientId = regclient(gMyIP);
						if (gClientId!=""){
						//create deafult tests"
						for (var i = 0; i < gProtocols.length; i++){
							addTest(gProtocols[i],gMyIP,getNextPort());
						}
						//display step 2 page
						gCurrStep=2;
						displayStep("Step2");
						loadSWF(); //loading of SWF will trigger execution of tests
						//loop for test results...blocking
						updateBaseCheck();
						}else{
							document.getElementById("Errmsg").innerHTML="Failed to retrieve client id from server.";
						}
					}else{
						document.getElementById("Errmsg").innerHTML="Invalid IP address.";
						document.getElementById("step1_myIP").focus();
					}
				}
			}
	 </script>
	 <p>
	<div id="Step1" class="MainContainer"style="display:block" >
		<center><img src="gremwell_logo.png" class="img_logo" /></center>
		<div class="main_text">To continue, we will require the following information from you:</div>
			<br /><br />
			<div class="main_text">Your client's IP address: <input class="step_input" id="step1_myIP" value="" len="15"></div>
			<br /><br />
	</div>
	<div id="Step2" class="MainContainer" style="display:none">
		<div class="main_text"><br />We are now going to determine which connection tracking modules are loaded on your gateway.
		<br />
		<ul>
			<li id="li_FTP">FTP ...</li>
			<li id="li_IRC">IRC ...</li>
			<li id="li_SIP">SIP ...</li>			
			<li id="li_H225">H.225 ...</li>
		</ul>
		</div>
	</div>
	<div id="Step3" class="MainContainer" style="display:none">
		pownage
	</div>
	<div id="ButtonFrame" class="ButtonFrame">
		<div id="Errmsg" class="errmsg"> </div>
		<center><input type=button class=step_next id=step1_next onclick="nextStep();" value="Proceed"/></center>
	</div>
	<div id="SWFContainer"></div>
	 </center>
	</body>
</html>
